import{S as I,i as L,s as H,e as J,b as E,B as M,h as i,k as v,q as D,a as F,l as y,m as w,r as R,c as O,n as W,F as d,u as A,w as Q,x as V,y as X,L as U,f as Y,t as Z,z as x,M as $,o as tt,N as et}from"../../chunks/index-471fb7b1.js";import{r as rt,a as st,b as ot,D as K,P as B,g as nt,c as at}from"../../chunks/workRecords-f7dfab88.js";function lt(a){let e,r=a[0]===C.Working?"Working":"Chilling",s,t,o,n,m,_,p,g;return{c(){e=v("h1"),s=D(r),t=F(),o=v("span"),n=D(a[1]),m=F(),_=v("h3"),p=D("Totally worked today: "),g=D(a[2]),this.h()},l(c){e=y(c,"H1",{class:!0});var u=w(e);s=R(u,r),t=O(u),o=y(u,"SPAN",{class:!0});var h=w(o);n=R(h,a[1]),h.forEach(i),u.forEach(i),m=O(c),_=y(c,"H3",{class:!0});var T=w(_);p=R(T,"Totally worked today: "),g=R(T,a[2]),T.forEach(i),this.h()},h(){W(o,"class","svelte-15cnyi8"),W(e,"class","svelte-15cnyi8"),W(_,"class","svelte-15cnyi8")},m(c,u){E(c,e,u),d(e,s),d(e,t),d(e,o),d(o,n),E(c,m,u),E(c,_,u),d(_,p),d(_,g)},p(c,u){u&1&&r!==(r=c[0]===C.Working?"Working":"Chilling")&&A(s,r),u&2&&A(n,c[1]),u&4&&A(g,c[2])},d(c){c&&i(e),c&&i(m),c&&i(_)}}}function it(a){let e,r;return{c(){e=v("h1"),r=D("Time to start working!")},l(s){e=y(s,"H1",{});var t=w(e);r=R(t,"Time to start working!"),t.forEach(i)},m(s,t){E(s,e,t),d(e,r)},p:M,d(s){s&&i(e)}}}function ct(a){let e;function r(o,n){return o[0]===C.NotStarted?it:lt}let s=r(a),t=s(a);return{c(){t.c(),e=J()},l(o){t.l(o),e=J()},m(o,n){t.m(o,n),E(o,e,n)},p(o,[n]){s===(s=r(o))&&t?t.p(o,n):(t.d(1),t=s(o),t&&(t.c(),t.m(e.parentNode,e)))},i:M,o:M,d(o){t.d(o),o&&i(e)}}}var C=(a=>(a[a.NotStarted=0]="NotStarted",a[a.Working=1]="Working",a[a.Chilling=2]="Chilling",a))(C||{});function ut(a,e,r){let{state:s}=e,{currentDuration:t}=e,{totallyWorked:o}=e;return a.$$set=n=>{"state"in n&&r(0,s=n.state),"currentDuration"in n&&r(1,t=n.currentDuration),"totallyWorked"in n&&r(2,o=n.totallyWorked)},[s,t,o]}class ft extends I{constructor(e){super(),L(this,e,ut,ct,H,{state:0,currentDuration:1,totallyWorked:2})}}function mt(a){let e,r,s,t,o,n=a[0]?"Pause":"Work",m,_,p,g,c,u,h,T=a[5]?"Share":"Save",q,f,S,b;return r=new ft({props:{state:a[3],currentDuration:a[1],totallyWorked:a[2]}}),{c(){e=v("main"),Q(r.$$.fragment),s=F(),t=v("footer"),o=v("button"),m=D(n),_=F(),p=v("section"),g=v("button"),c=D("Reset"),u=F(),h=v("button"),q=D(T),this.h()},l(l){e=y(l,"MAIN",{class:!0});var k=w(e);V(r.$$.fragment,k),k.forEach(i),s=O(l),t=y(l,"FOOTER",{class:!0});var N=w(t);o=y(N,"BUTTON",{class:!0});var j=w(o);m=R(j,n),j.forEach(i),_=O(N),p=y(N,"SECTION",{class:!0});var P=w(p);g=y(P,"BUTTON",{class:!0});var z=w(g);c=R(z,"Reset"),z.forEach(i),u=O(P),h=y(P,"BUTTON",{class:!0});var G=w(h);q=R(G,T),G.forEach(i),P.forEach(i),N.forEach(i),this.h()},h(){W(e,"class","svelte-1iq0viv"),W(o,"class","svelte-1iq0viv"),W(g,"class","outline warning svelte-1iq0viv"),W(h,"class","outline svelte-1iq0viv"),W(p,"class","svelte-1iq0viv"),W(t,"class","svelte-1iq0viv")},m(l,k){E(l,e,k),X(r,e,null),E(l,s,k),E(l,t,k),d(t,o),d(o,m),d(t,_),d(t,p),d(p,g),d(g,c),d(p,u),d(p,h),d(h,q),f=!0,S||(b=[U(o,"click",a[4]),U(g,"click",a[7]),U(h,"click",a[6])],S=!0)},p(l,[k]){const N={};k&8&&(N.state=l[3]),k&2&&(N.currentDuration=l[1]),k&4&&(N.totallyWorked=l[2]),r.$set(N),(!f||k&1)&&n!==(n=l[0]?"Pause":"Work")&&A(m,n)},i(l){f||(Y(r.$$.fragment,l),f=!0)},o(l){Z(r.$$.fragment,l),f=!1},d(l){l&&i(e),x(r),l&&i(s),l&&i(t),S=!1,$(b)}}}function _t(a,e,r){var q;let s=!1,t=[],o="",n="";const m=async()=>{var f;r(8,t=rt(await st())),t.length&&r(0,s=((f=t.at(-1))==null?void 0:f.isWorking)??!1)};tt(()=>{m()});const _=()=>{r(0,s=!s),r(8,t=ot(t,s))},p=!!((q=navigator.canShare)!=null&&q.call(navigator,{text:""})),g=()=>{var l;const f=(l=t.find(k=>k.isWorking))==null?void 0:l.timestamp.toFormat(B),S=t.findLast(k=>k.isWorking),b=at(t);return`${f}	${S.timestamp.toFormat(B)}			${b}`},c=async()=>{var S;const f=g();if((S=navigator.canShare)!=null&&S.call(navigator,{text:f}))try{await navigator.share({title:"Share all barcodes",text:f}),console.log("shared",f)}catch(b){console.error(b)}else{const b=document.createElement("a"),l=K.now().toFormat("yyyy-mm-dd");b.href=window.URL.createObjectURL(new File([f],`report_${l}.txt`,{type:"text/plain"})),b.download=l,b.click()}},u=()=>{if(t.length){const f=K.now();if(t[0].timestamp.day!==f.day){T();return}r(1,o=f.diff(t.at(-1).timestamp).toFormat(B)),r(2,n=nt(t))}window.requestAnimationFrame(u)};window.requestAnimationFrame(u);let h;const T=()=>{r(8,t=[]),r(0,s=!1),T()};return a.$$.update=()=>{a.$$.dirty&257&&(t.length?s?r(3,h=C.Working):r(3,h=C.Chilling):r(3,h=C.NotStarted))},[s,o,n,h,_,p,c,T,t]}class dt extends I{constructor(e){super(),L(this,e,_t,mt,H,{})}}function ht(a){let e,r,s,t,o;return t=new dt({}),{c(){e=v("meta"),r=F(),s=v("section"),Q(t.$$.fragment),this.h()},l(n){const m=et("svelte-goo5iw",document.head);e=y(m,"META",{name:!0,content:!0}),m.forEach(i),r=O(n),s=y(n,"SECTION",{class:!0});var _=w(s);V(t.$$.fragment,_),_.forEach(i),this.h()},h(){document.title="Time Tracker",W(e,"name","description"),W(e,"content","App to track working and rest time"),W(s,"class","svelte-1jlhe5t")},m(n,m){d(document.head,e),E(n,r,m),E(n,s,m),X(t,s,null),o=!0},p:M,i(n){o||(Y(t.$$.fragment,n),o=!0)},o(n){Z(t.$$.fragment,n),o=!1},d(n){i(e),n&&i(r),n&&i(s),x(t)}}}class gt extends I{constructor(e){super(),L(this,e,null,ht,H,{})}}export{gt as default};
